-- 1. 70년대 여자사원 전씨 의 이름 주민번호 부서명 직급

SELECT EMP_ID , EMP_NAME, DEPT_TITLE, JOB_NAME
FROM EMPLOYEE E, DEPARTMENT , JOB J
WHERE E.DEPT_CODE = DEPT_ID(+) AND E.JOB_CODE = J.JOB_CODE AND SUBSTR(EMP_NO,8,1) = '2' 
AND SUBSTR(EMP_NO,1,2) > 69 AND SUBSTR(EMP_NO,1,2) < 80 AND EMP_NAME LIKE '전%' ;

-- 2 나이상 가장 막내의 사원코드, 사원명, 부서명, 직급명
SELECT EMP_ID, EMP_NAME, DEPT_CODE, JOB_NAME
FROM EMPLOYEE E, JOB J
WHERE E.JOB_CODE = J.JOB_CODE ; 


-- 3. 이름에 형 들어가는 사원의 사원코드 사원명 직급 조회
SELECT EMP_ID, EMP_NAME, JOB_NAME
FROM EMPLOYEE E, JOB J
WHERE E.JOB_CODE = J.JOB_CODE AND EMP_NAME LIKE '%형%';

-- 4. 부서코드가 D5이거나 D6인 사원의 사원명, 직급명 ,부서코드, 부서명 조회
SELECT EMP_NAME, JOB_NAME , DEPT_CODE, DEPT_TITLE
FROM EMPLOYEE E, DEPARTMENT D, JOB J
WHERE E.DEPT_CODE = D.DEPT_ID AND E.JOB_CODE = J.JOB_CODE AND DEPT_CODE IN ('D5','D6');

--5. 보너스를 받는 사원 사원명, 부서명, 지역명 조회
SELECT EMP_NAME, DEPT_TITLE, LOCAL_NAME
FROM EMPLOYEE E, DEPARTMENT D, LOCATION L
WHERE E.DEPT_CODE = D.DEPT_ID AND D.LOCATION_ID = L.LOCAL_CODE AND BONUS IS NOT NULL;


-- 6. 사원명, 직급명 ,부서명, 지역명 조회

SELECT EMP_NAME, JOB_NAME, DEPT_TITLE, LOCAL_NAME
FROM EMPLOYEE E, DEPARTMENT D, JOB J , LOCATION L
WHERE E.DEPT_CODE = D.DEPT_ID AND E.JOB_CODE = J.JOB_CODE AND D.LOCATION_ID = L.LOCAL_CODE;


-- 7. 한국이나 일본에서 근무 중인 사원의 사원 명, 부서명 지역명 국가명 조회
SELECT EMP_NAME, DEPT_TITLE, LOCAL_NAME, NATIONAL_NAME
FROM EMPLOYEE E, DEPARTMENT D, LOCATION L , NATION N
WHERE E.DEPT_CODE = D.DEPT_ID AND D.LOCATION_ID = L.LOCAL_CODE AND 
L.NATIONAL_CODE = N.NATIONAL_CODE AND NATIONAL_NAME IN('한국', '일본');

-- 8. 사원마다 같은 부서에서 일하는 사원의 이름 전부 조회하기


-- 9. 보너스 없고 직급 코드가 J4이거나 J7인 사원의 이름, 직급명, 급여조회NVL
SELECT EMP_NAME, JOB_NAME, NVL(SALARY,0)
FROM EMPLOYEE E, JOB J
WHERE E.JOB_CODE = J.JOB_CODE AND J.JOB_CODE IN('J4', 'J7');


-- 10. 보너스 포함 연봉이 높은 5명의 사번, 이름, 부서명, 직급 , 입사일, 순위 조회
WITH SAL_HIRE 
AS ( SELECT EMP_ID, EMP_NAME, DEPT_TITLE, JOB_NAME, HIRE_DATE FROM EMPLOYEE E, DEPARTMENT D, JOB J
WHERE E.DEPT_CODE = D.DEPT_ID AND E.JOB_CODE = J.JOB_CODE ORDER BY SALARY DESC)
SELECT * FROM SAL_HIRE WHERE ROWNUM <= 5;



SELECT ROWNUM,SALARY FROM EMPLOYEE WHERE ROWNUM <= 5;
--??

-- 11. 부서별 급여 합계가 전체 급여 총 합의 20%보다 많은 부서의부서 명, 부서 별 급여

